---
title: "Cutting fasta down to contig names"
output: html_notebook
---
This notebook cuts the Pinsky_contigs1050.fasta file down into names only for use in vcf filtering.

```{r}
library(tidyverse)

raw_fasta <- read_lines("~/Downloads/Pinsky_contigs1050.fasta")
names<- tibble(full = raw_fasta) %>% 
  filter(grepl("dDocent", full)) %>% 
  mutate(full = substr(full, 2, 100))
```

This is a list of contigs, but in order to filter in vcf, we also need a list of SNPs found on those contigs.  
full_snps_list.txt is the output of the fasta_check.R script and has more contigs than what we sent to mybaits.  But does it have all of the contigs sent to mybaits?

```{r}
raw_full_snps <- read_lines("~/Documents/genomics/data/full_snps_list.txt")
full_snps <- tibble(full = raw_full_snps) %>% 
  separate(full, into = c("name", "loc"), sep = " ")
```

Which contig names are in the contigs file that are not in the full_snps file?
```{r}
lack <- anti_join(names, full_snps, by = c("full" = "name"))
```

There are 446 contigs sent to mybaits that are not in the full_snps list.  Are they in the seq16_03_SNPs.txt?

```{r}
raw_seq16 <- read_lines("~/Documents/genomics/data/for_mybaits/seq16_03_SNPs.txt")
full_seq16 <- tibble(full = raw_seq16) %>% 
  separate(full, into = c("full", "loc"), sep = " ")
```
Which contig names are in lack that aren't in seq16?
```{r}
really_lack <- anti_join(lack, full_seq16, by = "full")
```
These are also not in seq16. Where did they come from?

Pull in all of the locations from TotalRawSnps from SEQ29
```{r}
raw_29 <- read_lines("~/Downloads/raw_kept.kept.sites")
full_29 <- tibble(full = raw_29) %>% 
  filter(grepl("Contig", full)) %>% 
  separate(full, into = c("full", "loc"), sep = "\t")
```
Are all of the "names" present?
```{r}
lack <- anti_join(names, full_29, by = "full")

# this is interesting so save it
# write_csv(lack, path = "SEQ29_missing_mybaits_contigs.csv")
```
90 of the contigs are not on the list but we can get positions for all of the others
```{r}
contigs_29 <- full_29 %>% 
  filter(full %in% names$full)
```
See if there are more positions and contigs in the total raw snps from seq17-03.
```{r}
raw17 <- read_lines("~/Downloads/17raw.kept.sites")
full17 <- tibble(full = raw17) %>% 
  filter(grepl("Contig", full)) %>% 
  separate(full, into = c("full", "loc"), sep = "\t")

lack17 <- anti_join(names, full17, by = "full")

contigs_17 <- full17 %>% 
  filter(full %in% names$full) %>% 
  distinct()
```

All positions and contigs in names are in seq17

Write out contigs_17 as the contig, position file to use for vcf filtering.

```{r}
write_delim(contigs_17, path = "mybaits_contigs_1050.txt", delim = " ", col_names = F)
```


