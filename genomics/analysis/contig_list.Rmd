---
title: "Make Contig List"
output: html_notebook
---

This takes our fasta file that we sent to mybaits and the mapped.bed file from dDocent and generates a mapped.bed file that can be used to filter vcf files.  
*Originally used the fasta_to_names.Rmd script but that generated the wrong type of list*

**Using --bed keeps anything on the list, but doesn't eliminate anything.  Create a list of contings to exclude.**

```{r setup}
library(tidyverse)
```

Find the fasta file
Read the fasta file
Generate a list of keepable contig names
```{r}
raw_fasta <- read_lines("~/Downloads/Pinsky_contigs1050.fasta")
names<- tibble(full = raw_fasta) %>% 
  filter(grepl("dDocent", full)) %>% 
  mutate(full = substr(full, 2, 100))
```

Find the mapped.bed file
read the mapped.bed file
```{r}
raw_bed <- read_lines("~/Downloads/mapped.bed")
bed <- tibble(full = raw_bed) %>% 
  separate(full, into = c("full", "start", "end"), sep = "\t")
```

Filter mapped bed file to only keep the lines that are in the contig list
```{r}
yes_bed <- bed %>% 
  filter(full %in% names$full)
no_bed <- bed %>% 
  filter(!full %in% names$full)
```
Write the new data to a mapped.bed file
```{r}
write_delim(bed, path = "mapped.bed", delim = "\t", col_names = F)
write_delim(bed, path = "exclude.bed", delim = "\t", col_names = F)
```
Send to amphiprion.
